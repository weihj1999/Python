Webpy + Apache with mod_wsgi


1. Download and install mod_wsgi from its website: 
http://code.google.com/p/modwsgi/. 
It will install a '.so' module in Apache module directory. e.g.

  /usr/lib64/httpd/modules/

2. Configure Apache to load mod_wsgi module and your project in httpd.conf:

  LoadModule wsgi_module modules/mod_wsgi.so

  WSGIScriptAlias /appname /var/www/webpy-app/code.py/

  Alias /appname/static /var/www/webpy-app/static/
  AddType text/html .py

  <Directory /var/www/webpy-app/>
      Order deny,allow
      Allow from all
  </Directory>

3. Sample file 'code.py':

  import web

  urls = (
      '/.*', 'hello',
      )

  class hello:
      def GET(self):
          return "Hello, world."

  application = web.application(urls, globals()).wsgifunc()      

4. Point your browser to 'http://your_server_name/appname' to verify whether it works
for you.

Note:

mod_wsgi + sessions

If you use sessions with mod_wsgi, you should change you code like below:

app = web.application(urls, globals())

curdir = os.path.dirname(__file__)
session = web.session.Session(app, web.session.DiskStore(os.path.join(curdir,'sessions')),)

application = app.wsgifunc()

mod_wsgi performance:

For mod_wsgi performance, please refer to mod_wsgi wiki page:

http://code.google.com/p/modwsgi/wiki/PerformanceEstimates

Appendix: Install mod_wsgi on a linux distribution

1. get the source code https://github.com/GrahamDumpleton/mod_wsgi/releases
such as, I choose the latest:

https://github.com/GrahamDumpleton/mod_wsgi/archive/4.4.21.tar.gz

2. unpack it with command:
#tar xvfz mod_wsgi-X.Y.tar.gz

3. configure the source code
# cd mod_wsgi-X.Y
#./configure

4. building the souce code
#make
and install the module to standard apache

#make install

 configure the source code
# cd mod_wsgi-X.Y
#./configure

4. building the souce code
#make
and install the module to standard apache

#make install

 configure the source code
# cd mod_wsgi-X.Y
#./configure

4. building the souce code
#make
and install the module to standard apache

#make install

 configure the source code
# cd mod_wsgi-X.Y
#./configure

4. building the souce code
#make
and install the module to standard apache

#make install

 configure the source code
# cd mod_wsgi-X.Y
#./configure

4. building the souce code
#make
and install the module to standard apache

#make install

 configure the source code
# cd mod_wsgi-X.Y
#./configure

4. building the souce code
#make
and install the module to standard apache

#make install

5. Loaing the module to apache

Notes:
1. error: no acceptable C compiler found in $PATH

solution: install gcc
#yum install gcc -y 

2. error: apxs command not found

it is because apache delve package missed so 

solution: install httpd-devel
#yum install -y httpd-devel

3. when install mod_wsgi successfully, you may get output like below;

----------------------------------------------------------------------
Libraries have been installed in:
   /usr/lib64/httpd/modules

If you ever happen to want to link against installed libraries
in a given directory, LIBDIR, you must either use libtool, and
specify the full pathname of the library, or use the `-LLIBDIR'
flag during linking and do at least one of the following:
   - add LIBDIR to the `LD_LIBRARY_PATH' environment variable
     during execution
   - add LIBDIR to the `LD_RUN_PATH' environment variable
     during linking
   - use the `-Wl,-rpath -Wl,LIBDIR' linker flag
   - have your system administrator add LIBDIR to `/etc/ld.so.conf'

See any operating system documentation about shared libraries for
more information, such as the ld(1) and ld.so(8) manual pages.
----------------------------------------------------------------------




